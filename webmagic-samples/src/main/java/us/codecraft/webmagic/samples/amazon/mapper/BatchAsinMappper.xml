<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="us.codecraft.webmagic.samples.amazon.dao.BatchAsinDao">

    <resultMap id="BatchAsinResultMap" type="BatchAsin">
        <result property="id" column="boa_id"/>
        <result property="siteCode" column="bas_code"/>
        <result property="batchNumber" column="bo_batch_num"/>
        <result property="asin" column="boa_asin"/>
        <result property="rootAsin" column="boa_root_asin"/>
        <result property="crawled" column="boa_crawled"/>
        <result property="progress" column="boa_progress"/>
        <result property="type" column="boa_type"/>
        <result property="startTime" column="boa_start_time"/>
        <result property="finishTime" column="boa_finish_time"/>
        <result property="extra" column="boa_extra"/>
    </resultMap>

    <select id="findByCode" resultMap="BatchAsinResultMap">
        SELECT * FROM batch_order_asin WHERE bo_batch_num = #{0};
    </select>

    <select id="find" parameterType="BatchAsin" resultMap="BatchAsinResultMap">
        SELECT * FROM batch_order_asin WHERE bo_batch_num = #{batchNumber} AND boa_asin = #{asin};
    </select>

    <update id="update" parameterType="BatchAsin">
        UPDATE batch_order_asin SET
        bas_code = #{siteCode},
        boa_asin = #{asin},
        boa_root_asin = #{rootAsin},
        boa_crawled = #{crawled},
        boa_progress = #{progress},
        boa_type = #{type},
        boa_start_time = #{startTime},
        boa_finish_time = #{finishTime},
        boa_extra = #{extra}
        WHERE
        bo_batch_num = #{batchNumber} AND boa_asin = #{asin};
    </update>

    <insert id="addAll" parameterType="java.util.List">
        INSERT INTO batch_order_asin(
        bas_code,bo_batch_num,boa_asin,boa_root_asin,boa_crawled,boa_progress,
        boa_type,boa_start_time,boa_finish_time,boa_extra
        )
        VALUES
        <foreach collection="list" item="item" index="index" separator=",">
            (
              #{item.siteCode},#{item.batchNumber},#{item.asin},#{item.rootAsin},#{item.crawled},#{item.progress},
              #{item.type},#{item.startTime},#{item.finishTime},#{item.extra}
            )
        </foreach>
    </insert>

</mapper>