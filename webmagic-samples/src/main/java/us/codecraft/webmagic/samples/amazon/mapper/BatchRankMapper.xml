<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="us.codecraft.webmagic.samples.amazon.dao.batch.BatchRankDao">
    <resultMap id="BatchRankMap" type="BatchRank">
        <id column="bor_id" property="id" />
        <result column="bor_batch_num" property="batchNum" />
        <result column="bor_keyword" property="keyword" />
        <result column="bad_code" property="departmentCode" />
        <result column="bas_code" property="siteCode" />
        <result column="saa_asin" property="asin" />
        <result column="bor_type" property="type" />
        <result column="bor_priority" property="priority" />
        <result column="bor_status" property="status" />
        <result column="bor_is_changed" property="isChanged" />
        <result column="bor_create_time" property="createTime" />
        <result column="bor_update_time" property="updateTime" />
    </resultMap>

    <insert id="addAll" parameterType="java.util.List">
        INSERT INTO batch_order_rank (
          bor_batch_num,
          bor_keyword,
          bas_code,
          saa_asin,
          bad_code,
          bor_type,
          bor_status,
          bor_priority,
          bor_is_changed,
          bor_create_time,
          bor_update_time
        ) VALUES
        <foreach collection="list" index="index" item="item" separator=",">
            (
              #{batchNum},
              #{keyword},
              #{siteCode},
              #{asin},
              #{departmentCode},
              #{type},
              #{status},
              #{priority},
              #{isChanged},
              CURRENT_TIMESTAMP,
              CURRENT_TIMESTAMP
            )
        </foreach>
    </insert>

    <update id="update" parameterType="BatchRank">
        UPDATE
          batch_order_rank
        SET
          bor_typ = #{type},
          bor_status = #{status},
          bor_is_changed = #{isChanged},
          bor_update_time = CURRENT_TIMESTAMP
        WHERE
          bor_id = #{id}
    </update>

    <select id="findByBatch" resultMap="BatchRankMap">
        SELECT
          *
        FROM
          batch_order_rank
        WHERE
          bor_batch_num = #{batchNum}
    </select>
</mapper>