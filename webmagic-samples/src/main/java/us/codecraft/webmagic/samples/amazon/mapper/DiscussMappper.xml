<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="us.codecraft.webmagic.samples.amazon.dao.DiscussDao">
    <!--设置domain类和数据库中表的字段一一对应，注意数据库字段和domain类中的字段名称不致，此处一定要！-->
    <resultMap id="DiscussResultMap" type="Discuss">
        <result column="star" property="star"/>
    </resultMap>
    <!-- 查询单条记录 -->
    <select id="findAll" resultMap="DiscussResultMap">
        SELECT * FROM amazon_discuss;
    </select>

    <insert id="add" parameterType="Discuss">
        <selectKey resultType="java.lang.Long">
            SELECT @@IDENTITY AS id
        </selectKey>
        INSERT INTO amazon_discuss (asin,title,time,content,version,person,buyStatus,star)
        VALUES (#{asin},#{title},#{time},#{content},#{version},#{person},#{buyStatus},#{star})
        ON DUPLICATE KEY UPDATE
        asin=#{asin},title=#{title},time=#{time},content=#{content},version=#{version},person=#{person},buyStatus=#{buyStatus},star=#{star}
    </insert>

    <insert id="addAll" parameterType="java.util.List">
        <selectKey resultType="java.lang.Long">
            SELECT @@IDENTITY AS id
        </selectKey>
        INSERT INTO amazon_discuss (
        asin,
        title,
        time,
        content,
        version,
        person,
        buyStatus,
        star)
        values
        <foreach collection="list" item="item" index="index" separator=",">
            (
            #{item.asin},#{item.title},
            #{item.time},#{item.content},
            #{item.version},
            #{item.person},
            #{item.buyStatus},
            #{item.star}
            )
        </foreach>
        ON DUPLICATE KEY UPDATE
        asin=VALUES(asin),
        title=VALUES(title),
        time=VALUES(time),
        content=VALUES(content),
        version=VALUES(version),
        person=VALUES(person),
        buyStatus=VALUES(buyStatus),
        star=VALUES(star)
    </insert>


</mapper>