<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="us.codecraft.webmagic.samples.amazon.dao.DiscussDao">

    <!-- 查询单条记录 -->
    <select id="findAll" resultType="Discuss">
        SELECT * FROM amazon_discuss;
    </select>

    <select id="findAllByAsin" parameterType="java.lang.String" resultType="Discuss">
        SELECT * FROM amazon_discuss WHERE asin = #{0};
    </select>

    <insert id="add" parameterType="Discuss">
        <selectKey resultType="java.lang.Long">
            SELECT @@IDENTITY AS id
        </selectKey>
        INSERT INTO amazon_discuss (asin,title,time,content,version,person,buyStatus,star,personID)
        VALUES (#{asin},#{title},#{time},#{content},#{version},#{person},#{buyStatus},#{star},#{personID})
        ON DUPLICATE KEY UPDATE
        asin=#{asin},title=#{title},time=#{time},content=#{content},version=#{version},person=#{person},buyStatus=#{buyStatus},star=#{star},personID=#{personID}
    </insert>

    <insert id="addAll" parameterType="java.util.List">
        <selectKey resultType="java.lang.Long">
            SELECT @@IDENTITY AS id
        </selectKey>
        INSERT INTO amazon_discuss (
        asin,title,time,content,version,person,buyStatus,star,personID)
        values
        <foreach collection="list" item="item" index="index" separator=",">
            (
            #{item.asin},#{item.title},
            #{item.time},#{item.content},
            #{item.version},
            #{item.person},
            #{item.buyStatus},
            #{item.star},
            #{item.personID}
            )
        </foreach>
        ON DUPLICATE KEY UPDATE
        asin=VALUES(asin),
        title=VALUES(title),
        time=VALUES(time),
        content=VALUES(content),
        version=VALUES(version),
        person=VALUES(person),
        buyStatus=VALUES(buyStatus),
        star=VALUES(star),
        personID=VALUES(personID)
    </insert>

</mapper>