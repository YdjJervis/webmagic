<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.eccang.spider.amazon.dao.pay.PayPackageStubDao">

    <cache eviction="LRU" type="com.eccang.spider.base.rediscache.RedisCache"/>

    <resultMap id="PayPackageStubResultMap" type="PayPackageStub">
        <id property="id" column="bpps_id"/>
        <result property="stubCode" column="bpps_code"/>
        <result property="payPackageCode" column="bpp_code"/>
        <result property="businessCode" column="besb_code"/>
        <result property="day" column="bpps_day"/>
        <result property="priority" column="bpps_priority"/>
        <result property="frequency" column="bpps_frequency"/>
        <result property="count" column="bpps_count"/>
        <result property="averageTime" column="bpps_average_time"/>
        <result property="price" column="bpps_price"/>
        <result property="createTime" column="bpps_create_time"/>
        <result property="updateTime" column="bpps_update_time"/>
    </resultMap>

    <insert id="addAll" parameterType="java.util.List">
        INSERT INTO base_pay_package_sub(
        bpps_code,
        bpp_code,
        besb_code,
        bpps_day,
        bpps_priority,
        bpps_frequency,
        bpps_count,
        bpps_average_time,
        bpps_price
        )
        VALUES
        <foreach collection="list" item="item" index="index" separator=",">
            (
            #{item.stubCode},
            #{item.payPackageCode},
            #{item.businessCode},
            #{item.day},
            #{item.priority},
            #{item.frequency},
            #{item.count},
            #{item.averageTime},
            #{item.price}
            )
        </foreach>
    </insert>

    <select id="findByCode" resultMap="PayPackageStubResultMap">
        SELECT * FROM base_pay_package_sub
        WHERE bpps_code = #{0};
    </select>

    <select id="findByPayPackage" resultMap="PayPackageStubResultMap">
        SELECT * FROM base_pay_package_sub
        WHERE
        bpp_code = #{0};
    </select>

    <select id="findTotalPrice" resultType="int">
        SELECT sum(bpps_price) FROM base_pay_package_sub
        WHERE
        bpp_code = #{0};
    </select>

    <select id="find" resultMap="PayPackageStubResultMap">
        SELECT * FROM base_pay_package_sub
        WHERE
        bpp_code = #{0}
        and
        besb_code = #{1};
    </select>

    <update id="update" parameterType="PayPackageStub">
        UPDATE base_pay_package_sub
        SET
        bpp_code = #{payPackageCode},
        besb_code = #{businessCode},
        bpps_day = #{day},
        bpps_priority = #{priority},
        bpps_frequency = #{frequency},
        bpps_count = #{count},
        bpps_average_time = #{averageTime},
        bpps_price = #{price}
        where
        bpps_code = #{stubCode}
    </update>

</mapper>